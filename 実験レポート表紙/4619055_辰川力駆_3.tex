\documentclass[12pt]{jarticle}
\usepackage{TUSIReport}
\usepackage{otf}
\usepackage[dvipdfmx]{graphicx}
\usepackage[dvipdfmx]{color}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{color}
\usepackage{hhline}
\usepackage{fancybox,ascmac}
\usepackage{multirow}
\usepackage{url}
\usepackage{bm}
\usepackage{listings,jlisting}

\lstdefinestyle{lstcpp}{
    language={c++},
    backgroundcolor={\color[gray]{.85}},
    basicstyle={\small},
    identifierstyle={\small},
    commentstyle={\small\ttfamily \color[rgb]{0,0.5,0}},
    keywordstyle={\small\bfseries \color[rgb]{1,0,0}},
    ndkeywordstyle={\small},
    stringstyle={\small\ttfamily \color[rgb]{0,0,1}},
    frame={tb},
    breaklines=true,
    columns=[l]{fullflexible},
    numbers=left,
    xrightmargin=0zw,
    xleftmargin=3zw,
    numberstyle={\scriptsize},
    stepnumber=1,
    numbersep=1zw,
    morecomment=[l]{//}
}
\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 表紙を出力する場合は，\提出者と\共同実験者をいれる
% \提出者{科目名}{課題名}{提出年}{提出月}{提出日}{学籍番号}{氏名}
% \共同実験者{一人目}{二人目}{..}{..}{..}{..}{..}{八人目}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\提出者{情報工学実験2}{実験テーマ3 情報通信シミュレーション}{2020}{11}{30}{4619055}{辰川力駆}
\共同実験者{}{}{}{}{}{}{}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 表紙を出力しない場合は，以下の「\表紙出力」をコメントアウトする
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\表紙出力

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 以下はレポート本体である．別途 TeXファイルを作成し \input 使っても良い
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{実験概要}
rand() によって発生させた乱数と、MT によって発生させた乱数それぞれに
ついて誤り率をプロットしたグラフを作成するなどをして、
ディジタル通信システムと誤り訂正符号の理解を深める。

\section{実験手順}
\begin{itemize}
    \item 系列長$K=4$の情報系列
          $w=(w_1,...,w_K) \in \{0,1\}$ を乱数によって
          発生させ、
          BSCの各$\epsilon$に対するビット誤り率の値をシミュレーション
          により求める。
          乱数の発生には、C 言語コンパイラ上で rand() 関数を用いたものと
          Mersenne Twister (MT) を用いた 2 種類のプログラムを作成する。
    \item 横軸を BSC の誤り確率 $\epsilon$、縦軸 (指数表示) を
          ビット誤り率 $P_e$ としてグラフにプロットする。
    \item 誤り確率の理論値 ($\epsilon$) を実線 (プロットなし) で表示してシミュレー
          ションで得られた値と比較する。
\end{itemize}

\section{実験結果}
\section{検討}
\subsection{課題1}
\begin{shadebox}
    シミュレーションによるビット誤り率と理論値が
    ほぼ同じ値になるにはどの程度のシミュレーション回数を実行する必要があるか。
\end{shadebox}
\subsection{課題2}
\begin{shadebox}
    $\epsilon$を非常に小さくした場合、これはどうなるか。
\end{shadebox}
\subsection{課題3}
\begin{shadebox}
    $\rm{rand()}$と$\rm{MT}$の違いは何か。
\end{shadebox}

\begin{figure}[h]
    \begin{center}
        %\includegraphics[scale=0.4]{}
    \end{center}
    \caption{全ての項目による対数尤度グラフ}
\end{figure}
\clearpage


図3の対数尤度関数で最大値を取っている$\theta$の値は、
$\theta=1.7$である。
よって自分の能力値は1.7であると推定できる。
また、情報量$I(\hat{\theta})$は各問題に関する情報量$I_i({\theta})$の
合計である。
したがって、8問の合計を求めたら良く、

である。

また、標準誤差は
\begin{eqnarray*}
    se(\hat{\theta})&=&I(\hat{\theta})^{-\frac{1}{2}}\\
    &= &\frac{1}{\sqrt{ 1.65559}}\\
    &\thickapprox& 0.77718
\end{eqnarray*}
である。

\subsection{課題3-4}
\begin{shadebox}
    課題1-3で解いた項目の$a_i$が全て「1」だった場合の能力値、情報量、
    標準誤差を求め、結果について考察する。
\end{shadebox}




\begin{table}[htb]
    \begin{center}
        \caption{G9メンバーの推定結果}
        \begin{tabular}{|c|r|r|r|r|r|r|r|}
            \hline
            学籍番号(46190)               & 15 & 28   & 38 & 55  & 58   & 64 & 94  \\
            \hline
            能力値$\theta$                & 0  & -0.1 & 1  & 1.7 & 0.4  & 1  & 1.3 \\
            \hline
            偏差値$S$                     & 45 & 45   & 60 & 70  & 61.7 & 70 & 70  \\
            \hline
            \multirow{8}{*}{解答した問題} & 5  & 1    & 3  & 3   & 8    & 1  & 3   \\
                                          & 11 & 5    & 8  & 9   & 20   & 15 & 6   \\
                                          & 36 & 20   & 16 & 21  & 28   & 28 & 20  \\
                                          & 49 & 25   & 49 & 24  & 35   & 46 & 34  \\
                                          &    &      & 52 & 30  & 42   & 52 & 45  \\
                                          &    &      &    & 35  & 46   &    &     \\
                                          &    &      &    & 40  &      &    &     \\
                                          &    &      &    & 51  &      &    &     \\
            \hline
        \end{tabular}
    \end{center}
\end{table}



\clearpage
% 付録
\appendix
\section{付録}
\begin{lstlisting}[style = lstcpp,caption=kadai3\_rand.cpp]
    //4619055 辰川力駆
    #include <random> // 乱数生成
    #include <stdio.h>
    #include <iostream>
    #include <iomanip>
    
    using namespace std;
    
    #define SIM 1000000
    
    #define real_rand (double)rand() / RAND_MAX; //RAND_MAXで割ることで0から1を返すようにしている。
    #define seed 55                              //学籍番号下２桁
    #define K 4                                  //系列長
    
    int main()
    {
        srand(seed);
        int w[4], e[4], y[4];
    
        cout << "# SIM:" << SIM << endl;
        cout << "# ep   # BER" << endl;
    
        double ep = 0;
        int count = 0;
        for (int i = 0; i < 12; i++) //12回で設定
        {
            count = 0;
            ep = 0.0001 * (i + 1);
    
            for (int s = 0; s < SIM; s++)
            {
                for (int j = 0; j < K; j++)
                {
                    double rd = real_rand; //乱数発生
                    w[j] = rd * 2;         //2倍することで0.5より大きいか小さいかを判定できる。
                }
                for (int j = 0; j < K; j++)
                {
                    double rd = real_rand; //乱数発生
                    if (rd <= ep)
                    {
                        e[j] = 1;
                    }
                    else
                    {
                        e[j] = 0;
                    }
                }
                for (int j = 0; j < K; j++)
                {
                    y[j] = w[j] ^ e[j];
                    count += w[j] ^ y[j];
                }
            }
            cout << fixed << setprecision(4) << ep;
            cout.unsetf(ios::fixed);
            cout << fixed << setprecision(7) << " " << (double)count / (K * SIM) << endl;
        }
    
        return 0;
    }
\end{lstlisting}

\begin{lstlisting}[style = lstcpp,caption=kadai3\_mt.cpp]
    //4619055 辰川力駆
    #include <random> // 乱数生成
    #include <stdio.h>
    #include <iostream>
    #include <iomanip>
    
    using namespace std;
    
    #define SIM 1000000
    
    #define seed 55 //学籍番号下２桁
    #define K 4     //系列長
    
    mt19937 mt(seed); //メルセンヌ・ツイスタ
    
    int main()
    {
        srand(seed);
        int w[4], e[4], y[4];
    
        uniform_real_distribution<double> rand_real(0, 1);
        normal_distribution<double> rand_n(0, 0.3);
    
        cout << "# SIM:" << SIM << endl;
        cout << "# ep   # BER" << endl;
    
        double ep = 0;
        int count = 0;
        for (int i = 0; i < 12; i++) //12回で設定
        {
            count = 0;
            ep = 0.0001 * (i + 1);
    
            for (int s = 0; s < SIM; s++)
            {
                for (int j = 0; j < K; j++)
                {
                    w[j] = rand_real(mt) * 2; //2倍することで0.5より大きいか小さいかを判定できる。
                }
                for (int j = 0; j < K; j++)
                {
                    if (rand_real(mt) <= ep)
                    {
                        e[j] = 1;
                    }
                    else
                    {
                        e[j] = 0;
                    }
                }
                for (int j = 0; j < K; j++)
                {
                    y[j] = w[j] ^ e[j];
                    count += w[j] ^ y[j];
                }
            }
            cout << fixed << setprecision(4) << ep;
            cout.unsetf(ios::fixed);
            cout << fixed << setprecision(7) << " " << (double)count / (K * SIM) << endl;
        }
    
        return 0;
    }
\end{lstlisting}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}